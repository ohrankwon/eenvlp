[{"path":"https://ohrankwon.github.io/eenvlp/articles/overview.html","id":"review-of-the-envelope-model","dir":"Articles","previous_headings":"","what":"Review of the Envelope Model","title":"Introduction of the Enhanced Envelope Estimator","text":"envelope model builds upon classical multivariate linear regression: y=Bx+ϵ,ϵ∼N(0,ΣX),   y = Bx + \\epsilon, ~ \\epsilon \\sim N(0,\\Sigma_X),  : y∈ℝry\\\\mathbb R^r vector response variables, x∈ℝpx\\\\mathbb R^p vector predictor variables, B∈ℝr×pB\\\\mathbb R^{r\\times p} unknown coefficient matrix, ϵ\\epsilon represents error vector. envelope model improves basic framework identifying subspace response vector unaffected changes predictor vector. Specifically, finds subspace ℰ⊆ℝr\\mathcal E \\subseteq \\mathbb{R}^r separates “material” variation (part important identifying relationship yy xx) “immaterial” variation (part affect relationship). separation reduces noise, leading accurate efficient estimation prediction. incorporating envelope concept, multivariate linear model can reformulated follows, represents envelope model: y=Γηx+ϵ,ϵ∼N(0,ΓΩΓT+Γ0Ω0Γ0T),   y = \\Gamma \\eta x + \\epsilon, ~ \\epsilon \\sim N(0,\\Gamma\\Omega\\Gamma^T + \\Gamma_0\\Omega_0\\Gamma_0^T),  : Γ∈ℝr×u\\Gamma \\\\mathbb{R}^{r \\times u} semi-orthogonal basis matrix envelope subspace, Γ0∈ℝr×(r−u)\\Gamma_0 \\\\mathbb{R}^{r \\times (r-u)} basis matrix orthogonal complement envelope subspace, η∈ℝu×p\\eta \\\\mathbb{R}^{u \\times p} reduced coefficient matrix, Ω∈ℝu×u\\Omega \\\\mathbb R^{u\\times u} Ω0∈ℝ(r−u)×(r−u)\\Omega_0 \\\\mathbb R^{(r-u)\\times (r-u)} positive definite matrices representing variances within outside envelope subspace.","code":""},{"path":"https://ohrankwon.github.io/eenvlp/articles/overview.html","id":"enhanced-envelope-estimator","dir":"Articles","previous_headings":"","what":"Enhanced Envelope Estimator","title":"Introduction of the Enhanced Envelope Estimator","text":"enhanced envelope estimator method estimating parameters within envelope model improve prediction performance low- high-dimensional settings. incorporates specialized regularization term estimation process, helps enhance model’s predictions controlling overfitting. enhanced envelope estimator obtained maximizing penalized likelihood function: argmax{ℒ(η,Γ,Γ0,Ω,Ω0)−nλ2ρ(η,Ω)}, \\arg\\max \\left\\{ \\mathcal L(\\eta,\\Gamma, \\Gamma_0, \\Omega, \\Omega_0) - \\frac{n\\lambda}{2} \\rho(\\eta,\\Omega)\\right\\},  : ℒ(η,Γ,Γ0,Ω,Ω0)\\mathcal L(\\eta,\\Gamma, \\Gamma_0, \\Omega, \\Omega_0) log-likelihood function envelope model, λ>0\\lambda>0 regularization parameter, ρ\\rho regularization term defined : ρ(η,Ω)=tr(ηTΩ−1η). \\rho(\\eta, \\Omega) = \\text{tr} (\\eta^T\\Omega^{-1}\\eta).  regularization term penalizes large values coefficient matrix η\\eta adjusted Ω−1/2\\Omega^{-1/2}, thereby improving model stability reducing overfitting. allowing flexibility selecting regularization parameter λ\\lambda, enhanced envelope estimator can achieve better prediction performance original envelope estimator. Moreover, regularization enables model handle cases number predictors pp exceeds number observations nn. original envelope estimator applied directly high-dimensional situations, whereas enhanced version, regularization, can effectively manage cases.","code":""},{"path":"https://ohrankwon.github.io/eenvlp/articles/tutorial.html","id":"data-overview","dir":"Articles","previous_headings":"","what":"Data Overview","title":"Tutorial on the eenvlp R package","text":"use cereal dataset, includes measurements two chemical properties (starch ash) along infrared spectroscopy predictors.","code":""},{"path":"https://ohrankwon.github.io/eenvlp/articles/tutorial.html","id":"load-and-inspect-the-dataset","dir":"Articles","previous_headings":"Data Overview","what":"Load and Inspect the Dataset","title":"Tutorial on the eenvlp R package","text":"First, let’s load dataset inspect structure understand dimensions data: cereal dataset consists 15 cereal samples, 145 infrared spectra (predictors) 2 chemical properties (responses). high-dimensional setting ideal demonstrating capabilities eenvlp package.","code":"data(cereal) # load data n <- nrow(cereal$x) # Number of observations r <- ncol(cereal$y) # Number of response variables p <- ncol(cereal$x) # Number of predictors ## n 15 ## r: 2 ## p: 145"},{"path":"https://ohrankwon.github.io/eenvlp/articles/tutorial.html","id":"goal-prediction-task","dir":"Articles","previous_headings":"Data Overview","what":"Goal – Prediction Task","title":"Tutorial on the eenvlp R package","text":"goal use enhanced envelope estimator predict chemical properties first cereal sample. split dataset training set test set:","code":"# Define training and test sets X_test <- cereal$x[1,] # The first observation as the test set Y_test <- cereal$y[1,] X_train <- cereal$x[-1,] # The remaining observations as the training set Y_train <- cereal$y[-1,]"},{"path":"https://ohrankwon.github.io/eenvlp/articles/tutorial.html","id":"model-fitting-enhanced-envelope-estimator","dir":"Articles","previous_headings":"","what":"Model Fitting – Enhanced Envelope Estimator","title":"Tutorial on the eenvlp R package","text":"fit enhanced envelope estimator, use cross-validation select optimal tuning parameters, λ\\lambda (regularization parameter) uu (dimension envelope subspace).","code":""},{"path":"https://ohrankwon.github.io/eenvlp/articles/tutorial.html","id":"define-sequences-for-tuning-parameters","dir":"Articles","previous_headings":"Model Fitting – Enhanced Envelope Estimator","what":"Define Sequences for Tuning Parameters","title":"Tutorial on the eenvlp R package","text":"begin defining sequences λ\\lambda uu:","code":"lambda.seq = 10^(seq(3, -3, length.out=20)) # Sequence of lambda values u.seq = c(1:r) # Sequence of u values cv.lamb.env = matrix(NA,length(lambda.seq),length(u.seq))"},{"path":"https://ohrankwon.github.io/eenvlp/articles/tutorial.html","id":"cross-validation-for-parameter-selection","dir":"Articles","previous_headings":"Model Fitting – Enhanced Envelope Estimator","what":"Cross-Validation for Parameter Selection","title":"Tutorial on the eenvlp R package","text":"Next, perform cross-validation find optimal values λ\\lambda uu:","code":"set.seed(11111) # Set a seed for reproducibility   for(i in 1:length(lambda.seq)){     for(j in 1:length(u.seq)){       cv.lamb.env[i,j] <- cv_eenvlp(X_train, Y_train, u=u.seq[j], lamb=lambda.seq[i], m=10, nperm=1)     }   }    # Identify the optimal parameters chosen <- which(cv.lamb.env == min(cv.lamb.env), arr.ind=TRUE) chosen.lamb <- lambda.seq[chosen[1]] chosen.u <- u.seq[chosen[2]] ## Optimal lambda: 0.004281332 ## Optimal u: 1"},{"path":"https://ohrankwon.github.io/eenvlp/articles/tutorial.html","id":"fit-the-eenvlp-model-using-optimal-parameters","dir":"Articles","previous_headings":"Model Fitting – Enhanced Envelope Estimator","what":"Fit the eenvlp Model Using Optimal Parameters","title":"Tutorial on the eenvlp R package","text":"optimal parameters determined, fit eenvlp model:","code":"fit_eenvlp <- eenvlp(X_train, Y_train, u = chosen.u, lamb = chosen.lamb)"},{"path":"https://ohrankwon.github.io/eenvlp/articles/tutorial.html","id":"prediction-on-test-data","dir":"Articles","previous_headings":"","what":"Prediction on Test Data","title":"Tutorial on the eenvlp R package","text":"use fitted model predict chemical properties test observation:","code":"predict_eenvlp <- pred_eenvlp(fit_eenvlp, X_test)"},{"path":"https://ohrankwon.github.io/eenvlp/articles/tutorial.html","id":"calculate-prediction-error","dir":"Articles","previous_headings":"Prediction on Test Data","what":"Calculate Prediction Error","title":"Tutorial on the eenvlp R package","text":"Finally, calculate prediction error evaluate model’s performance:","code":"prediction_error <- (predict_eenvlp - Y_test)^2 ## Prediction error: 0.03283565 0.2265817"},{"path":"https://ohrankwon.github.io/eenvlp/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Oh-Ran Kwon. Maintainer.","code":""},{"path":"https://ohrankwon.github.io/eenvlp/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Kwon O (2024). eenvlp: Enhanced Response Envelope. R package version 1.0.0, https://ohrankwon.github.io/eenvlp/.","code":"@Manual{,   title = {eenvlp: Enhanced Response Envelope},   author = {Oh-Ran Kwon},   year = {2024},   note = {R package version 1.0.0},   url = {https://ohrankwon.github.io/eenvlp/}, }"},{"path":[]},{"path":"https://ohrankwon.github.io/eenvlp/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Enhanced Response Envelope","text":"eenvlp R package fits enhanced response envelope model multivariate linear regression, introduced paper: Oh-Ran Kwon Hui Zou (2024) Enhanced Response Envelope via Envelope Regularization, Journal American Statistical Association, 1-22. DOI: 10.1080/01621459.2024.2368844 Please see Overview explanation enhanced response envelope Tutorial example use package.","code":""},{"path":"https://ohrankwon.github.io/eenvlp/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Enhanced Response Envelope","text":"Open R prompt. , type following commands:","code":"library(devtools) devtools::install_github(\"ohrankwon/eenvlp\") library(eenvlp)"},{"path":"https://ohrankwon.github.io/eenvlp/reference/cereal.html","id":null,"dir":"Reference","previous_headings":"","what":"Cereal data — cereal","title":"Cereal data — cereal","text":"Cereal data contain 15 cereals 145 infrared spectra two chemical properties, starch ash, measured.","code":""},{"path":"https://ohrankwon.github.io/eenvlp/reference/cereal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cereal data — cereal","text":"","code":"data(cereal)"},{"path":"https://ohrankwon.github.io/eenvlp/reference/cereal.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cereal data — cereal","text":"data Varmuza Filzmoser (2016).","code":""},{"path":"https://ohrankwon.github.io/eenvlp/reference/cereal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cereal data — cereal","text":"list following elements: x matrix predictors: 15 rows 145 columns. y matrix responses: 15 rows 2 columns.","code":""},{"path":"https://ohrankwon.github.io/eenvlp/reference/cereal.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Cereal data — cereal","text":"Varmuza, K. Filzmoser, P. (2016), Introduction multivariate statistical analysis chemometrics, CRC press.","code":""},{"path":"https://ohrankwon.github.io/eenvlp/reference/cereal.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cereal data — cereal","text":"","code":"# load data set data(cereal)  # the dimension of predictors dim(cereal$x) #> [1]  15 145  # the dimension of responses dim(cereal$y) #> [1] 15  2"},{"path":"https://ohrankwon.github.io/eenvlp/reference/cv_eenvlp.html","id":null,"dir":"Reference","previous_headings":"","what":"Cross validation for eenvlp — cv_eenvlp","title":"Cross validation for eenvlp — cv_eenvlp","text":"Compute prediction error enhanced response envelope estimator using m-fold cross validation.","code":""},{"path":"https://ohrankwon.github.io/eenvlp/reference/cv_eenvlp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cross validation for eenvlp — cv_eenvlp","text":"","code":"cv_eenvlp(X, Y, u, lamb, m, nperm, index = NULL, X.scale = TRUE)"},{"path":"https://ohrankwon.github.io/eenvlp/reference/cv_eenvlp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cross validation for eenvlp — cv_eenvlp","text":"X Predictors. n p matrix, p number predictors. predictors can univariate multivariate, discrete continuous. Y Multivariate responses. n r matrix, r number responses n number observations. responses must continuous variables. u Dimension envelope. integer 0 r. lamb regularization parameter. positive value. m positive integer used indicate m-fold cross validation. nperm positive integer indicating number permutations observations, m-fold cross validation run permutation. index Either NULL n vector list indices 1 n. NULL (default), samples ordered randomly split. vector provided, samples ordered accroding given list indices split. X.scale boolean. TRUE (default), columns training X divided standard deviations. False, scaling done.","code":""},{"path":"https://ohrankwon.github.io/eenvlp/reference/cv_eenvlp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cross validation for eenvlp — cv_eenvlp","text":"function computes prediction errors using m-fold cross validation.  fixed dimension u, data randomly partitioned m parts, part turn used testing prediction performance rest m-1 parts used training.  process repeated nperm times, average prediction error reported. Y multivariate, identity inner product used computing prediction errors.","code":""},{"path":"https://ohrankwon.github.io/eenvlp/reference/cv_eenvlp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cross validation for eenvlp — cv_eenvlp","text":"output real nonnegative number. cvPE prediction error estimated m-fold cross validation.","code":""},{"path":"https://ohrankwon.github.io/eenvlp/reference/cv_eenvlp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cross validation for eenvlp — cv_eenvlp","text":"","code":"data(cereal) cvPE <- cv_eenvlp(cereal$x, cereal$y, u=1, lamb=1e-07, m=2, nperm=1) cvPE #> [1] 0.9505697"},{"path":"https://ohrankwon.github.io/eenvlp/reference/eenvlp.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit the enhanced response envelope model — eenvlp","title":"Fit the enhanced response envelope model — eenvlp","text":"Fit enhanced response envelope model multivariate linear regression dimension u.","code":""},{"path":"https://ohrankwon.github.io/eenvlp/reference/eenvlp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit the enhanced response envelope model — eenvlp","text":"","code":"eenvlp(X, Y, u, lamb, init = NULL, X.scale = TRUE)"},{"path":"https://ohrankwon.github.io/eenvlp/reference/eenvlp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit the enhanced response envelope model — eenvlp","text":"X Predictors. n p matrix, p number predictors. predictors can univariate multivariate, discrete continuous. Y Multivariate responses. n r matrix, r number responses n number observations. responses must continuous variables. u Dimension envelope. integer 0 r. lamb regularization parameter. positive value. init user-specified value Gamma envelope subspace. r u matrix. default one generated function envMU. X.scale boolean. TRUE (default), columns training X divided standard deviations. False, scaling done.","code":""},{"path":"https://ohrankwon.github.io/eenvlp/reference/eenvlp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fit the enhanced response envelope model — eenvlp","text":"function fits envelope model responses predictors, $$  Y = \\mu + \\Gamma\\eta X+\\varepsilon, \\Sigma=\\Gamma\\Omega\\Gamma'+\\Gamma_{0}\\Omega_{0}\\Gamma'_{0}  $$  using penalized maximum likelihood estimation.  dimension envelope 1 r-1, starting value blockwise coordinate descent algorithm Cook et al. (2016) implemented.  dimension r, envelope model degenerates standard multivariate linear regression.  dimension 0, means X Y uncorrelated, fitting different.","code":""},{"path":"https://ohrankwon.github.io/eenvlp/reference/eenvlp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit the enhanced response envelope model — eenvlp","text":"output list contains following components: beta envelope estimator regression coefficients. Sigma envelope estimator error covariance matrix. Gamma orthonormal basis envelope subspace. Gamma0 orthonormal basis complement envelope subspace. eta coordinates beta respect Gamma. Omega coordinates Sigma respect Gamma. Omega0 coordinates Sigma respect Gamma0. mu estimated intercept. n number observations data. X.center numeric centering used. X.scale numeric scaling used. used, NULL.","code":""},{"path":"https://ohrankwon.github.io/eenvlp/reference/eenvlp.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fit the enhanced response envelope model — eenvlp","text":"Cook, R. D., Forzani, L. Su, Z. (2016) Note Fast Envelope Estimation. Journal Multivariate Analysis. 150, 42-54.","code":""},{"path":"https://ohrankwon.github.io/eenvlp/reference/eenvlp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit the enhanced response envelope model — eenvlp","text":"","code":"data(cereal) m <- eenvlp(cereal$x, cereal$y, u=1, lamb=1e-07) m$Gamma #>            [,1] #> [1,] -0.6244626 #> [2,]  0.7810547"},{"path":"https://ohrankwon.github.io/eenvlp/reference/pred_eenvlp.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimation or prediction for rrenv — pred_eenvlp","title":"Estimation or prediction for rrenv — pred_eenvlp","text":"Perform estimation prediction reduced rank envelope model.","code":""},{"path":"https://ohrankwon.github.io/eenvlp/reference/pred_eenvlp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimation or prediction for rrenv — pred_eenvlp","text":"","code":"pred_eenvlp(m, Xnew)"},{"path":"https://ohrankwon.github.io/eenvlp/reference/pred_eenvlp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimation or prediction for rrenv — pred_eenvlp","text":"m list containing estimators statistics inherited eenvlp. Xnew value X estimate predict Y.  p dimensional vector n p matrix.","code":""},{"path":"https://ohrankwon.github.io/eenvlp/reference/pred_eenvlp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimation or prediction for rrenv — pred_eenvlp","text":"function evaluates reduced rank envelope model new value Xnew.  can perform estimation: find fitted value X = Xnew, prediction: predict Y X = Xnew.  covariance matrix standard errors also provided.","code":""},{"path":"https://ohrankwon.github.io/eenvlp/reference/pred_eenvlp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimation or prediction for rrenv — pred_eenvlp","text":"value fitted value predicted value evaluated Xnew.","code":""},{"path":"https://ohrankwon.github.io/eenvlp/reference/pred_eenvlp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimation or prediction for rrenv — pred_eenvlp","text":"","code":"data(cereal) m <- eenvlp(cereal$x[-1,], cereal$y[-1,], u=1, lamb=1e-07) pred <- pred_eenvlp(m, cereal$x[1,]) pred #>         [,1]     [,2] #> [1,] -1.0287 1.350548"}]
